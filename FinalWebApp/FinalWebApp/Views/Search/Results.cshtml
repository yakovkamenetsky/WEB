@model FinalWebApp.Dto.ResultModel

@{
	ViewData["Title"] = "Results";
	var checkin = Model.checkin;
	var checkout = Model.checkout;
	var cityName = Model.CityName;
	var toPrice = Model.toPrice;
	var place = Model.place;
	var isAi = Model.isAiSearch;
}
<div class="row">
    <div class="col-md-3"></div>
    <aside class="filter hotel-result-list col-md-2">
        <form action="/search" id="filter" hidden>
            <input value="@checkin" name="checkin" form="filter" hidden />
            <input value="@checkout" name="checkout" form="filter" hidden />
            <input value="@place" name="place" form="filter" hidden />
            @if (!string.IsNullOrEmpty(Model.CityName))
            {
                <input value="@cityName" name="cityName" form="filter" hidden />
                <br />
            }
        </form>
        <div>
            @if (Model.cityAggregation.Count() != 0)
            {
                <div class="filter-label">Filter by city</div>
                foreach (var name in Model.cityAggregation)
                {
                    <input type="submit" value="@name.CityName" name="cityName" form="filter" />
                    <br />
                }
            }
        </div>

        <div class="filter-label">Filter by price</div>
        <div>
            @foreach (var price in Model.PriceAggregation.OrderByDescending(x => x.MaxPrice))
            {
                <div>
                    Less Then 
                    <span>
                        <input type="submit" value="@price.MaxPrice" name="toprice" form="filter" />
                    </span>
                </div>
            }

        </div>
    </aside>
    <ul class="hotel-result-list col-md-9 col-md-offset-3">
        @foreach (var hotel in Model.hotels)
        {
            <li class="row hotel-result col-md-12">
                <div class="col-md-4 hotel-image">
                    <img src="~/images/HotelsImages/@hotel.Id/image.jpg" style="object-fit:cover; width:100%" />
                </div>
                <div class="col-md-5 hotel-title" style="height:200px">
                    <h2>
                        @hotel.Name
                        <br />
                    </h2>
                    <h5>
                        @hotel.Address
                    </h5>
                </div>
                <div class="center-block col-md-3" style="height:200px">
                    <div class="hotel-ofer center-block">
                        <h2 class="price center-block">
                            @hotel.Price<span> $</span>
                        </h2>
                        @{
                            var rooms = "rooms";
                            if (hotel.Available == 0)
                            {
                                 <div class="notavailable">
                                    Not available any more!
                                 </div>
                            }
                            else if (hotel.Available == 1)
                            {
                                rooms = "room";
                            }
                            else //if(hotel.Available < 10)
                            {
                                <div class="availabe">
                                    @hotel.Available @rooms left
                                </div>
                            }
                        }

                        @if (hotel.Available>0)
                        {
                             <form action="/Search/HotelDetails" method="post" id="offer-form"></form>
                              <div class="input-group-btn">
                                  <input value="@checkin" name="checkin" form="offer-form" hidden />
                                <input value="@checkout" name="checkout" form="offer-form" hidden />
                                <input value="@isAi.ToString()" name="isAiSearch" form="offer-form" hidden />
                                <input value="@Model.Features?.Age" name="userAge" form="offer-form" hidden />
                                <input value="@Model.Features?.Gender" name="userGender" form="offer-form" hidden />
                                <input value="@Model.Features?.FamilyStatus" name="userFamilyStatus" form="offer-form" hidden />
                                <input value="@Model.Features?.hobby" name="userHobby" form="offer-form" hidden />
                                <input value="@Model.Features?.purpose" name="userPurpose" form="offer-form" hidden />
                                <button class="btn btn-info" type="submit" form="offer-form" value="@hotel.Id" name="id">View Details</button>
                            </div>
                        }
                    </div>
			    </div>
            </li>
        }
        @if (Model.hotels.Count == 0)
        {
            var text = "" + Model.place + "'";
            if (Model.toPrice != 0)
            {
                text += " and lower than " + Model.toPrice;
            }

            <div class="no-results">
                <h4>
                    no results found for  '@text'
                </h4>
            </div>
        }

    </ul>
</div>